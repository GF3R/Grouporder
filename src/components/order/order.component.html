<body>
  <h2>Group Order: {{ currentGroupOrderName }}</h2>

  <div *ngIf="currentOrders$ | async as orders">
    <table mat-table [dataSource]="orders" class="mat-elevation-z8">
      <ng-container matColumnDef="customerName">
        <th mat-header-cell *matHeaderCellDef>Name</th>
        <td mat-cell *matCellDef="let order">
          <div *ngIf="!isEditMode">{{ order.customerName }}</div>
          <input
            *ngIf="isEditMode"
            [(ngModel)]="order.customerName"
            (ngModelChange)="onChange(order)"
          />
        </td>
      </ng-container>

      <ng-container matColumnDef="items">
        <th mat-header-cell *matHeaderCellDef>Foodlist</th>
        <td mat-cell *matCellDef="let order">
          <div *ngIf="!isEditMode">{{ order.items }}</div>
          <input
            *ngIf="isEditMode"
            [(ngModel)]="order.items"
            (ngModelChange)="onChange(order)"
          />
        </td>
      </ng-container>

      <ng-container matColumnDef="total">
        <th mat-header-cell *matHeaderCellDef>Total</th>
        <td mat-cell *matCellDef="let order">
          <div *ngIf="!isEditMode">{{ order.total }}</div>
          <input
            *ngIf="isEditMode"
            [(ngModel)]="order.total"
            (ngModelChange)="onChange(order)"
          />
        </td>
      </ng-container>

      <tr
        mat-header-row
        *matHeaderRowDef="['customerName', 'items', 'total']"
      ></tr>
      <tr
        mat-row
        *matRowDef="let row; columns: ['customerName', 'items', 'total']"
        (click)="onRowClick(row.id)"
        [style.background]="isSelected(row.id) ? 'rgb(172, 172, 172)' : ''"
      ></tr>
    </table>
    <button mat-raised-button class="no-click">
      Total sum: {{ totalSum$ | async }}
    </button>

    <button
      (click)="save()"
      mat-raised-button
      style="margin-top: 10px; float: right"
      *ngIf="isEditMode"
    >
      Save
    </button>
    <button
      (click)="cancel()"
      mat-raised-button
      style="margin-top: 10px; float: right"
      *ngIf="isEditMode"
    >
      Cancel
    </button>
    <button
      (click)="edit()"
      mat-raised-button
      style="margin-top: 10px; float: right"
      *ngIf="!isEditMode"
    >
      Edit
    </button>
    <button
      (click)="deleteOrder()"
      style="margin-top: 10px; margin-left: 10px"
      mat-raised-button
    >
      Delete selected order/s
    </button>
  </div>
  <br />
  <app-add-order-item
    [parentItems]="grandparentItems"
    (itemsChange)="onItemsChange($event)"
    [groupOrderId]="currentGroupOrderId"
  ></app-add-order-item>
</body>
